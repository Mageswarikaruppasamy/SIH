<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add a Map with Directions to Ajmer</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"/>
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>

    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f7f9fc;
      }
      .menu {
        background-color: #2c3e50; /* Darker shade for elegance */
        width: 16%;
        height: 100vh;
        position: fixed;
        color: white;
        padding: 15px;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */
        transition: 0.3s ease-in-out;
      }
      
      .menu h2 {
        text-align: center;
        font-size: 18px;
        margin-bottom: 20px;
        color: #ecf0f1; /* Lighter shade for contrast */
      }
      
      .menu ul {
        list-style: none;
        padding: 0;
      }
      
      .menu ul li {
        margin: 10px 0;
        font-size: 16px; /* Slightly larger for better readability */
      }
      
      .menu ul li a {
        color: white;
        text-decoration: none;
        display: flex;
        align-items: center;
        padding: 10px;
        border-radius: 5px;
        transition: 0.3s;
      }
      
      .menu ul li a:hover {
        background-color: #3498db; /* Attractive blue hover effect */
        color: #fff;
        transform: scale(1.05); /* Slight zoom effect on hover */
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
      }
      
      .menu ul li a i {
        margin-right: 10px; /* Space for icons */
        color: #e9e7cc; /* Eye-catching icon color */
      }
      
      .menu ul li a.active {
        background-color: #5d6179; /* Highlighted active link */
        color: #fff;
      }
      .content {
        margin-left: 16%; /* Adjusted to account for smaller sidebar */
        padding: 20px;
      }
      .truck-info {
        margin-top: 15px;
        background-color: #fff;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        font-size: 14px; /* Reduced font size */
      }
      #map {
        height: 350px;
        margin-top: 15px;
        border-radius: 8px;
      }
      .info-block {
        background-color: #e9ecef;
        padding: 8px;
        border-radius: 5px;
        margin-bottom: 10px;
        font-size: 14px; /* Reduced font size */
      }
      .info-block strong {
        font-size: 14px; /* Reduced font size */
      }
      .info-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .navbar {
        background-color: #2c3e50;
        color: white;
        padding: 10px 20px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .navbar-title {
        flex: 1;
        padding-left: 350px;
        text-align: center;
        font-size: 24px;
        font-weight: bold;
      }
      .navbar-search {
        padding-right: 15px;
        position: relative;
      }

      .navbar-search i {
        position: absolute;
        top: 50%;
        right: 28px;
        transform: translateY(-50%);
        color: #999;
      }
      .navbar-search input {
        border-radius: 20px;
        border: 1px solid #ccc;
        padding: 5px 15px;
        outline: none;
      }
      .navbar-search button {
        position: absolute;
        right: 0;
        border: none;
        background-color: #3498db;
        color: white;
        border-radius: 20px;
        padding: 5px 10px;
        cursor: pointer;
      }
      .info-block {
        padding: 5px;
    }
    
    #tcu-status {
        color: green;
        font-weight: bold;
    }

     
    </style>
  </head>
  <body>
    <!-- Title Bar -->
    <div class="navbar">
        <div class="navbar-title">DASHBOARD</div>
        <div class="navbar-search">
          <input type="text" placeholder="Search...">
          <i class="fas fa-search"></i>
        </div>
    </div>
    <!-- Menu bar -->
<div class="menu">
  <ul>
    <li><a href="#"><i class="fas fa-home"></i> Home</a></li>
    <li><a href="truckdetails.html"><i class="fas fa-truck"></i> Truck Details</a></li>
    <li><a href="driver.html"><i class="fas fa-id-card"></i> Driver Info</a></li>
    <li><a href="index.html" class="active"><i class="fas fa-map-marker-alt"></i> Live Tracking</a></li>
    <li><a href="#"><i class="fas fa-route"></i> Geofences</a></li>

    <!-- 3PL Partners with Bookings as collapsible -->
    <li>
      <a href="#collapseBookings" data-bs-toggle="collapse" aria-expanded="false"><i class="fas fa-people-carry"></i> 3PL Partners</a>
      <ul id="collapseBookings" class="collapse list-unstyled">
        <li><a href="#"><i class="fas fa-calendar-alt"></i> Bookings</a></li>
      </ul>
    </li>

    <!-- New Schedules Menu Item -->
    <li><a href="#"><i class="fas fa-calendar-check"></i> Schedules</a></li>

    <li><a href="report.html"><i class="fas fa-chart-line"></i> Reports</a></li>
  </ul>
</div>

<!-- Include Bootstrap 5 JS and Popper.js (required for some Bootstrap components) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Main Content Area -->
    <div class="content">

    <!-- Truck Information Section -->
<div class="truck-info">
  <h3>Truck Information</h3>
  <div class="row">
    <!-- Row 1 (4 Columns) -->
    <div class="col-md-3">
      <div class="info-block">
        <p><strong>Truck ID:</strong> 2013081234</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="info-block">
        <p><strong>Driver Name:</strong> Mr.Nikumbh</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="info-block">
        <p><strong>Load Details:</strong> <span id="load-details">9.63 tons</span></p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="info-block">
        <p><strong>Booking Status:</strong> <span id="booking-status">No</span></p>
      </div>
    </div>
  </div>
  <div class="row">
    <!-- Row 2 (4 Columns) -->
    <div class="col-md-3">
      <div class="info-block">
        <p><strong>Estimated Time:</strong> <span id="duration"></span></p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="info-block">
        <p><strong>Distance:</strong> <span id="distance"></span></p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="info-block">
        <p><strong>Destination:</strong> <span id="destination">Ajmer</span></p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="info-block">
        <p><strong>TCU Status:</strong> <span id="tcu-status" style="color: green;">Online</span></p>
      </div>
    </div>
  </div>
</div>




      <!-- Map Section -->
      <div id="map"></div>
    </div>

    <!-- Google Maps and Script -->
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAcEARwy22d2atZr5W31x9N90DBr_ZDF8U&libraries=places&v=beta"
      defer
    ></script>
    <script>
      var map;
      var directionsService;
      var directionsRenderer;
      var point = { lat: 23.0225, lng: 72.5714 }; // Initial point (Ahmedabad)
      var destination = { lat: 26.4499, lng: 74.6399 }; // Ajmer

      const routeCoordinates1 = [
        { lat: 23.1143, lng: 72.6750 },     // Ahmedabad, Gujarat
        { lat: 23.4157, lng: 72.8329 },     // 2
        { lat: 23.8183, lng: 72.9999 },     // 3
        { lat: 23.9580, lng: 73.2710 },     // 4
        { lat: 24.1176, lng: 73.3630 },     // 5
        { lat: 24.2238, lng: 73.3565 },     // 6
        { lat: 24.3679, lng: 73.3970 },     // 7
        { lat: 24.4018, lng: 73.5092 },     // 8
        { lat: 24.4707, lng: 73.5947 },     // 9
        { lat: 24.7508, lng: 73.7579 },     // 10
        { lat: 25.0696, lng: 73.8640 },     // 11
        { lat: 25.1132, lng: 73.8590 },     // 12
        { lat: 25.2786, lng: 73.7828 },     // 13
        { lat: 25.5253, lng: 73.8665 },     // 14
        { lat: 25.6231, lng: 73.9939 },     // 15
        { lat: 25.7933, lng: 74.0982 },     // 16
        { lat: 25.9559, lng: 74.2258 },     // 17
        { lat: 26.1958, lng: 74.4437 },     // 18
        { lat: 26.3276, lng: 74.5585 },     // 19
        { lat: 26.4528, lng: 74.6715 },     // 19
        { lat: 26.4450, lng: 74.6350 }      // Ajmer, Rajasthan
      ];

      const routeCoordinates2 = [
        { lat: 26.4499, lng: 74.6399 },     // Ajmer
        { lat: 26.5155, lng: 74.7075 },     // 2
        { lat: 26.5993, lng: 74.8700 },     // 3
        { lat: 26.6301, lng: 75.0879 },     // 4
        { lat: 26.7454, lng: 75.3229 },     // 5
        { lat: 26.8292, lng: 75.5679 },     // 6
        { lat: 26.9124, lng: 75.7873 },     // Jaipur
      ]

      function initMap() {
        map = new google.maps.Map(document.getElementById("map"), {
          center: point,
          zoom: 7
        });

        directionsService = new google.maps.DirectionsService();
        directionsRenderer = new google.maps.DirectionsRenderer();
        directionsRenderer.setMap(map);

        changepoint();
      }

      function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }

      async function changepoint() {
        for (let i = 0; i < routeCoordinates1.length; i++) {
          point = routeCoordinates1[i];
          await sleep(2000);
          calculateAndDisplayRoute();

            // Update load based on current location
            if (i === 0) {
                updateLoad(9.63); // Load at Ahmedabad
                updateDestination("Ajmer"); // Initial destination
            } else if (i === routeCoordinates1.length - 1) {
                destination = { lat: 26.9124, lng: 75.7873 }; // Ajmer to Jaipur
                updateLoad(11); // Load at Ajmer
                updateDestination("Jaipur"); // Update destination
                alert("Reached Ajmer\n Next destination is Jaipur");
            }

          if (i === routeCoordinates1.length - 1) {
            destination = { lat: 26.9124, lng: 75.7873 }; // Ajmer to Jaipur
            alert("Reached Ajmer\n Next destination is Jaipur")
            updateLoad(10.86); // Load at Ajmer
            for (let i = 0; i < routeCoordinates2.length; i++) {
              point = routeCoordinates2[i];
              await sleep(2500);
              calculateAndDisplayRoute();
              if (i === routeCoordinates2.length - 1) {
                updateLoad(12); // Load at Jaipur
                alert("Reached Jaipur")
              }
            }
          }
        }
      }

      function updateLoad(load) {
        document.getElementById("load-details").textContent = load + " tons";
      }

      function updateDestination(destination) {
        document.getElementById("destination").textContent = destination;
      }

      function calculateAndDisplayRoute() {
        directionsService.route(
          {
            origin: point,
            destination: destination,
            travelMode: 'DRIVING'
          },
          function (response, status) {
            if (status === 'OK') {
              directionsRenderer.setDirections(response);
              const leg = response.routes[0].legs[0];
              document.getElementById('distance').textContent = leg.distance.text;
              document.getElementById('duration').textContent = leg.duration.text;
            } else {
              console.error('Directions request failed due to ' + status);
            }
          }
        );
      }

      window.onload = initMap;
    </script>
  </body>
</html>
